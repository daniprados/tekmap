// TekMap by comunicatek.com  under the mit license.
// Author:  Dani Prados
// http://code.comunicatek.com
(function(b){function i(a,c){var d,f,g,e={position:new google.maps.LatLng(a.lat,a.lng),map:c,draggable:a.draggable};if(a.icon)if(typeof a.icon==="object"){f=new google.maps.Size(a.icon.size[0],a.icon.size[0]);d=a.icon.base?new google.maps.Point(a.icon.base[0],a.icon.base[1]):new google.maps.Point(0,0);g=new google.maps.Point(a.icon.origin[0],a.icon.origin[1]);d=new google.maps.MarkerImage(a.icon.url,f,d,g);b.extend(e,e,{icon:d})}else b.extend(e,e,{icon:a.icon});if(a.shadow)if(typeof a.shadow==="object"){f=
new google.maps.Size(a.shadow.size[0],a.shadow.size[0]);d=a.shadow.base?new google.maps.Point(a.shadow.base[0],a.shadow.base[1]):new google.maps.Point(0,0);g=new google.maps.Point(a.shadow.origin[0],a.shadow.origin[1]);d=new google.maps.MarkerImage(a.shadow.url,f,d,g);b.extend(e,e,{shadow:d})}else b.extend(e,e,{shadow:a.shadow});var h=new google.maps.Marker(e);b.fn.TekMap.markers.push(h);if(a.infowindow){var j=new google.maps.InfoWindow({content:a.infowindow});google.maps.event.addListener(h,"click",
function(){j.open(c,h)})}var k=a.drag||b.noop;a.draggable&&google.maps.event.addListener(h,"dragend",function(){k(h)})}function l(){var a=b.fn.TekMap.opts,c=a.mapoptions,d=new google.maps.LatLng(a.lat,a.lng);c.center=d;c=new google.maps.Map(this,c);a.click&&google.maps.event.addListener(c,"click",a.click);d=b(this);for(var f=0;f<a.markers.length;f++)i(a.markers[f],c);d.data("tekmap",c)}b.fn.TekMap=function(a){window.console&&window.console.log&&window.console.log("tekmap initialized");b.fn.TekMap.opts=
b.extend({},b.fn.TekMap.defaults,a);b.fn.TekMap.markers=[];return this.each(l)};b.fn.TekMarker=function(a){b.fn.TekMap.p=b.extend({},b.fn.TekMarker.defaults,a);if(a.addres){var c=this;(new google.maps.Geocoder).geocode({address:a.addres},function(d,f){f==google.maps.GeocoderStatus.OK&&b.each(d,function(g,e){b.fn.TekMap.p.lat=e.geometry.location.lat();b.fn.TekMap.p.lng=e.geometry.location.lng();c.each(b.fn.TekMarker.marker)})});return this}else return this.each(b.fn.TekMarker.marker)};b.fn.TekMarker.marker=
function(){var a=b.fn.TekMap.p,c=b.fn.TekMap.map;c||(c=b(this).data("tekmap"));i(a,c)};b.fn.TekMap.markers=[];b.fn.TekMap.defaults={lat:42,lng:3,click:jQuery.noop,mapoptions:{zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:false},markers:[]};b.fn.TekMarker.defaults={draggable:false}})(jQuery);