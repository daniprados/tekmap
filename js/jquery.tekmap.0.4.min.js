// TekMap by comunicatek.com  under the mit license.
// Author:  Dani Prados  http://code.comunicatek.com
(function(a){function g(b,c){var e={position:new google.maps.LatLng(b.lat,b.lng),map:c,draggable:b.draggable};b.icon&&a.extend(e,e,{icon:b.icon});var d=new google.maps.Marker(e);a.fn.TekMap.markers.push(d);if(b.infowindow){var h=new google.maps.InfoWindow({content:b.infowindow});google.maps.event.addListener(d,"click",function(){h.open(c,d)})}var f=b.drag||a.noop;b.draggable&&google.maps.event.addListener(d,"dragend",function(){f(d)})}function i(){var b=a.fn.TekMap.opts,c=b.mapoptions,e=new google.maps.LatLng(b.lat, b.lng);c.center=e;c=new google.maps.Map(this,c);b.click&&google.maps.event.addListener(c,"click",b.click);e=a(this);for(var d=0;d<b.markers.length;d++)g(b.markers[d],c);e.data("tekmap",c)}a.fn.TekMap=function(b){window.console&&window.console.log&&window.console.log("tekmap initialized");a.fn.TekMap.opts=a.extend({},a.fn.TekMap.defaults,b);a.fn.TekMap.markers=[];return this.each(i)};a.fn.TekMarker=function(b){a.fn.TekMap.p=a.extend({},a.fn.TekMarker.defaults,b);if(b.addres){var c=this;(new google.maps.Geocoder).geocode({address:b.addres}, function(e,d){d==google.maps.GeocoderStatus.OK&&a.each(e,function(h,f){a.fn.TekMap.p.lat=f.geometry.location.lat();a.fn.TekMap.p.lng=f.geometry.location.lng();c.each(a.fn.TekMarker.marker)})});return this}else return this.each(a.fn.TekMarker.marker)};a.fn.TekMarker.marker=function(){var b=a.fn.TekMap.p,c=a.fn.TekMap.map;c||(c=a(this).data("tekmap"));g(b,c)};a.fn.TekMap.markers=[];a.fn.TekMap.defaults={lat:42,lng:3,click:jQuery.noop,mapoptions:{zoom:12,mapTypeId:google.maps.MapTypeId.ROADMAP,scrollwheel:false}, markers:[]};a.fn.TekMarker.defaults={draggable:false}})(jQuery);